<h1>Users List</h1>

<button type="button" onclick="filter_email()">Filter .com email</button>

  <table id="mytable">
    <tr>
      <th>First Name</th>
      <th>Last Name</th>
      <th><a href="#" onclick="sortTable();return false;">Email</a></th>
      <th>Phone</th>
      <th>Company</th>
    </tr>
    <% @users.each do |user| %>
    <tr>
      <td><%= user.first_name %></td>
      <td><%= user.last_name %></td>
      <td><%= user.email_address %></td>
      <td><%= user.phone_number %></td>
      <td></td>

    </tr>
    <% end  %>
  </table>

<script>
    function filter_email(){
        var table = document.getElementById("mytable");
        var rows = document.getElementsByTagName('tr');
        for(var i=1; i<rows.length;i++){
            col = rows[i].getElementsByTagName('td')[2];
            if(col){
                if(col.innerHTML.toUpperCase().indexOf(".COM") >-1){
                    rows[i].style.display = "";
                }else{
                    rows[i].style.display = "none";
                }

            }

        }
    }
    function sortTable() {
        // show all rows that was hidden
        var rows = document.getElementsByTagName('tr');
        for(i = 1;i<rows.length;i++){
            if(rows[i].style.display == "none"){
                rows[i].style.display = "";

            }

        }

        var table, rows, switching, i, x, y, shouldSwitch;
        table = document.getElementById("mytable");
        switching = true;
        /* Make a loop that will continue until
        no switching has been done: */
        while (switching) {
            // Start by saying: no switching is done:
            switching = false;
            rows = table.getElementsByTagName("tr");
            /* Loop through all table rows (except the
            first, which contains table headers): */
            for (i = 1; i < (rows.length - 1); i++) {
                // Start by saying there should be no switching:
                shouldSwitch = false;
                /* Get the two elements you want to compare,
                one from current row and one from the next: */
                x = rows[i].getElementsByTagName("td")[2];
                y = rows[i + 1].getElementsByTagName("td")[2];
                // Check if the two rows should switch place:
                if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                    // I so, mark as a switch and break the loop:
                    shouldSwitch= true;
                    break;
                }
            }
            if (shouldSwitch) {
                /* If a switch has been marked, make the switch
                and mark that a switch has been done: */
                rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                switching = true;
            }
        }
    }

</script>
